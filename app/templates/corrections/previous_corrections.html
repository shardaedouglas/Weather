{% extends "base.html" %}
{% block title %}View Previous Corrections{% endblock %}
{% block content %}

<div class="container-md">
  <div class="container-md">
    <div class="row g-3">
      <div class="col g-3">
        <h1>View Previous Corrections</h1>
        <p>This is a brief description.</p>
      </div>
    </div>
  </div>


  <div class="container">
    <div id="spinner" class="spinner-border text-info text-center" style="display:block; margin-left: auto; margin-right: auto; margin-top: 20px;" >
    </div>
    <div class="row">
      <div class="col">
        <div class="table-responsive-lg">
          <table class="table table-light table-striped text-center" id="PrevCorrectionsTable" style="table-layout: fixed; width: 100%;">
            <thead>
              <tr>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">User</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">GHCN ID</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Date</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Element</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Action</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">O Value</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">M Flag</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Q Flag</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">S Flag</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">E Value</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">E Flag</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Source</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Correction Submission Date</th>
                <th class="text-center" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Datzilla Number</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Custom CSS for PrevCorrectionsTable -->
<style>
#PrevCorrectionsTable {
  table-layout: fixed;
  width: 100%;
}

#PrevCorrectionsTable th,
#PrevCorrectionsTable td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 0;
}

/* Specific column widths for better layout */
#PrevCorrectionsTable th:nth-child(1),  /* User */
#PrevCorrectionsTable td:nth-child(1) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(2),  /* GHCN ID */
#PrevCorrectionsTable td:nth-child(2) {
  width: 10%;
}

#PrevCorrectionsTable th:nth-child(3),  /* Date */
#PrevCorrectionsTable td:nth-child(3) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(4),  /* Element */
#PrevCorrectionsTable td:nth-child(4) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(5),  /* Action */
#PrevCorrectionsTable td:nth-child(5) {
  width: 6%;
}

#PrevCorrectionsTable th:nth-child(6),  /* O Value */
#PrevCorrectionsTable td:nth-child(6) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(7),  /* M Flag */
#PrevCorrectionsTable td:nth-child(7) {
  width: 6%;
}

#PrevCorrectionsTable th:nth-child(8),  /* Q Flag */
#PrevCorrectionsTable td:nth-child(8) {
  width: 6%;
}

#PrevCorrectionsTable th:nth-child(9),  /* S Flag */
#PrevCorrectionsTable td:nth-child(9) {
  width: 6%;
}

#PrevCorrectionsTable th:nth-child(10), /* E Value */
#PrevCorrectionsTable td:nth-child(10) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(11), /* E Flag */
#PrevCorrectionsTable td:nth-child(11) {
  width: 6%;
}

#PrevCorrectionsTable th:nth-child(12), /* Source */
#PrevCorrectionsTable td:nth-child(12) {
  width: 8%;
}

#PrevCorrectionsTable th:nth-child(13), /* Correction Submission Date */
#PrevCorrectionsTable td:nth-child(13) {
  width: 12%;
}

#PrevCorrectionsTable th:nth-child(14), /* Datzilla Number */
#PrevCorrectionsTable td:nth-child(14) {
  width: 10%;
}

/* Tooltip for truncated text */
#PrevCorrectionsTable th[title],
#PrevCorrectionsTable td[title] {
  cursor: help;
}

/* Dark mode adjustments */
.dark-mode #PrevCorrectionsTable th,
.dark-mode #PrevCorrectionsTable td {
  border-color: #4a5568;
}

/* High contrast mode adjustments */
.high-contrast #PrevCorrectionsTable th,
.high-contrast #PrevCorrectionsTable td {
  border: 2px solid #000000 !important;
}

.dark-mode.high-contrast #PrevCorrectionsTable th,
.dark-mode.high-contrast #PrevCorrectionsTable td {
  border: 2px solid #ffffff !important;
}
</style>

<script>
$(document).ready(function(){
        $('#PrevCorrectionsTable').dataTable({
          pageLength: 25,
        });

        
        updatePrevCorrTable();
        
  });



function updatePrevCorrTable() {
  $('#spinner').show();
  $('#PrevCorrectionsTable').hide();


  $.ajax({
    url: '/corrections/previous/get',
    method: 'GET',
    contentType: 'application/json', 
    // data: data,  // Send data as JSON
    success: function(response) {
        // Handle processing
        // console.log("Correction Data Recieved");
        // console.log(response);
        $('#PrevCorrectionsTable').DataTable().clear().rows.add(response).draw();
        $('#spinner').hide();
        $('#PrevCorrectionsTable').show();
    },
    error: function(xhr, status, error) {
        console.error("Error:", error);
        handleAjaxError(xhr, status, error, "There was an error processing your request.");
        $('#PrevCorrectionsTable').DataTable().clear();
        $('#spinner').hide();
        $('#PrevCorrectionsTable').show();
    }
    });

}
</script>


{% endblock content %}