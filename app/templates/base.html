<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title> {% block title %} GHCN {% endblock title %}</title>
        <!--
        <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/error-popup.css') }}">
        <!-- <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css" />
  
        <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script> -->
        <link href="https://cdn.datatables.net/v/dt/dt-2.2.2/r-3.0.3/datatables.min.css" rel="stylesheet">
 
        <script src="https://cdn.datatables.net/v/dt/dt-2.2.2/r-3.0.3/datatables.min.js"></script>

        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <!-- Tailwind CSS via CDN -->


        <!-- Global Accessibility CSS -->
        <style>
            /* Global accessibility styles */
            .high-contrast {
                filter: contrast(150%) brightness(120%);
            }
            
            .high-contrast .card {
                border: 2px solid #000000 !important;
            }
            
            .high-contrast .btn {
                border-width: 2px !important;
            }
            
            .high-contrast .navbar {
                border-bottom: 2px solid #000000 !important;
            }
            
            .high-contrast .dropdown-menu {
                border: 2px solid #000000 !important;
            }
            
            .high-contrast .form-control {
                border-width: 2px !important;
            }
            
            .high-contrast .table {
                border: 2px solid #000000 !important;
            }
            
            .high-contrast .table th,
            .high-contrast .table td {
                border: 1px solid #000000 !important;
            }
            
            /* Enhanced focus indicators */
            .enhanced-focus *:focus {
                outline: 3px solid #0d6efd !important;
                outline-offset: 2px !important;
                box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25) !important;
            }
            
            .enhanced-focus .btn:focus {
                outline: 3px solid #0d6efd !important;
                outline-offset: 2px !important;
            }
            
            .enhanced-focus .form-control:focus {
                outline: 3px solid #0d6efd !important;
                outline-offset: 2px !important;
            }
            
            .enhanced-focus .nav-link:focus {
                outline: 3px solid #0d6efd !important;
                outline-offset: 2px !important;
            }
            
            .enhanced-focus .dropdown-item:focus {
                outline: 3px solid #0d6efd !important;
                outline-offset: 2px !important;
            }
            
            /* Reduce motion */
            .reduce-motion * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .reduce-motion .motion-element {
                animation: none !important;
            }
            
            /* Dark mode enhancements */
            .dark-mode {
                background-color: #1a1a1a !important;
                color: #e2e8f0 !important;
            }
            
            .dark-mode .navbar {
                background-color: #2d3748 !important;
                border-bottom: 1px solid #4a5568 !important;
            }
            
            .dark-mode .navbar-nav .nav-link {
                color: #e2e8f0 !important;
            }
            
            .dark-mode .navbar-nav .nav-link:hover {
                color: #ffffff !important;
            }
            
            .dark-mode .dropdown-menu {
                background-color: #2d3748 !important;
                border: 1px solid #4a5568 !important;
            }
            
            .dark-mode .dropdown-item {
                color: #e2e8f0 !important;
            }
            
            .dark-mode .dropdown-item:hover {
                background-color: #4a5568 !important;
                color: #ffffff !important;
            }
            
            .dark-mode .card {
                background-color: #2d3748 !important;
                border: 1px solid #4a5568 !important;
                color: #e2e8f0 !important;
            }
            
            .dark-mode .btn-primary {
                background-color: #3182ce !important;
                border-color: #3182ce !important;
            }
            
            .dark-mode .btn-secondary {
                background-color: #4a5568 !important;
                border-color: #4a5568 !important;
            }
            
            .dark-mode .btn-outline-primary {
                color: #3182ce !important;
                border-color: #3182ce !important;
            }
            
            .dark-mode .btn-outline-primary:hover {
                background-color: #3182ce !important;
                border-color: #3182ce !important;
            }
            
            .dark-mode .form-control {
                background-color: #4a5568 !important;
                border: 1px solid #718096 !important;
                color: #e2e8f0 !important;
            }
            
            .dark-mode .form-control:focus {
                background-color: #4a5568 !important;
                border-color: #3182ce !important;
                color: #e2e8f0 !important;
            }
            
            .dark-mode .table {
                color: #e2e8f0 !important;
            }
            
            .dark-mode .table-striped > tbody > tr:nth-of-type(odd) > td {
                background-color: rgba(255, 255, 255, 0.05) !important;
            }
            
            .dark-mode .bg-light {
                background-color: #4a5568 !important;
            }
            
            .dark-mode .text-muted {
                color: #a0aec0 !important;
            }
            
            /* High contrast dark mode */
            .dark-mode.high-contrast {
                background-color: #000000 !important;
                color: #ffffff !important;
            }
            
            .dark-mode.high-contrast .card {
                background-color: #000000 !important;
                border: 2px solid #ffffff !important;
                color: #ffffff !important;
            }
            
            .dark-mode.high-contrast .navbar {
                background-color: #000000 !important;
                border-bottom: 2px solid #ffffff !important;
            }
            
            .dark-mode.high-contrast .btn {
                border-width: 2px !important;
            }
            
            /* User Avatar Styles */
            .user-avatar {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: linear-gradient(135deg, #056FB7 0%, #003087 100%);
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            
            .user-avatar:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 8px rgba(5,111,183,0.3);
                background: linear-gradient(135deg, #003087 0%, #056FB7 100%);
            }
            
            .user-initials {
                color: white;
                font-weight: 600;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            /* Dark mode avatar adjustments */
            .dark-mode .user-avatar {
                background: linear-gradient(135deg, #056FB7 0%, #003087 100%);
                border: 2px solid #4a5568;
            }
            
            .dark-mode .user-avatar:hover {
                background: linear-gradient(135deg, #003087 0%, #056FB7 100%);
                box-shadow: 0 4px 8px rgba(5,111,183,0.4);
            }
            
            /* High contrast mode avatar adjustments */
            .high-contrast .user-avatar {
                background: #000000 !important;
                border: 2px solid #ffffff !important;
            }
            
            .dark-mode.high-contrast .user-avatar {
                background: #ffffff !important;
                border: 2px solid #000000 !important;
            }
            
            .dark-mode.high-contrast .user-initials {
                color: #000000 !important;
            }
            
            /* Navbar Toggler Styles */
            .navbar-toggler {
                border: 1px solid #056FB7;
                padding: 0.25rem 0.5rem;
                background-color: transparent;
            }
            
            .navbar-toggler:focus {
                box-shadow: 0 0 0 0.2rem rgba(5, 111, 183, 0.25);
            }
            
            .navbar-toggler-icon {
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='%23056FB7' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
            }
            
            /* Bootstrap handles responsive visibility automatically with navbar-expand-lg */
            
            /* Dark mode navbar-toggler */
            .dark-mode .navbar-toggler {
                border-color: #ffffff;
            }
            
            .dark-mode .navbar-toggler-icon {
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='%23ffffff' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
            }
            
            /* Mobile user avatar adjustments */
            .user-avatar-mobile {
                width: 35px;
                height: 35px;
            }
            
            .user-avatar-mobile .user-initials {
                font-size: 12px;
            }
            
            /* Ensure proper spacing for mobile layout */
            @media (max-width: 991.98px) {
                .navbar .container-fluid {
                    flex-direction: column;
                    align-items: stretch;
                }
                
                .navbar-toggler {
                    align-self: flex-end;
                    margin-top: 0.5rem;
                }
            }
        </style>

        <script>
            // Global accessibility initialization
            $(document).ready(function() {
                initializeAccessibilitySettings();
            });

            // Initialize all accessibility settings
            function initializeAccessibilitySettings() {
                // Apply dark theme
                if (readCookie("theme") == "dark") {
                    $("html").addClass("dark-mode");
                }

                // Apply font size
                var fontResize = readCookie("font-resize");
                if (fontResize) {
                    $("html").css("font-size", (100 + parseInt(fontResize)) + "%");
                }

                // Apply high contrast
                if (readCookie("high-contrast") == "true") {
                    $("html").addClass("high-contrast");
                }

                // Apply enhanced focus indicators
                if (readCookie("focus-indicators") == "true") {
                    $("html").addClass("enhanced-focus");
                }

                // Apply reduce motion
                if (readCookie("reduce-motion") == "true") {
                    $("html").addClass("reduce-motion");
                }

                // Apply tooltips
                if (readCookie("tooltips") == "true") {
                    enableTooltips(true);
                } else {
                    enableTooltips(false);
                }
            }

            // Create/Read/Erase Cookies
            function createCookie(name, value, days) {
                if (days) {
                    var date = new Date();
                    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                    var expires = "; expires=" + date.toGMTString();
                }
                else var expires = "";
                document.cookie = name + "=" + value + expires + "; path=/";
            }

            function readCookie(name) {
                var nameEQ = name + "=";
                var ca = document.cookie.split(';');
                for (var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }

            function eraseCookie(name) {
                createCookie(name, "", -1);
            }

            function enableTooltips(bool) {
                if (bool) {
                    $(".tt").tooltip('enable');
                } else {
                    $(".tt").tooltip('disable');
                }
            }

            // Global keyboard shortcuts
            $(document).keydown(function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case '+':
                        case '=':
                            e.preventDefault();
                            increaseFontSize();
                            break;
                        case '-':
                            e.preventDefault();
                            decreaseFontSize();
                            break;
                        case 'd':
                            e.preventDefault();
                            toggleTheme();
                            break;
                        case 'r':
                            e.preventDefault();
                            resetAccessibilitySettings();
                            break;
                    }
                }
            });

            // Global accessibility functions
            function increaseFontSize() {
                var currentSize = parseInt(readCookie("font-resize")) || 0;
                var newSize = currentSize + 10;
                $("html").css("font-size", (100 + newSize) + "%");
                createCookie("font-resize", newSize, "");
            }

            function decreaseFontSize() {
                var currentSize = parseInt(readCookie("font-resize")) || 0;
                var newSize = currentSize - 10;
                $("html").css("font-size", (100 + newSize) + "%");
                createCookie("font-resize", newSize, "");
            }

            function toggleTheme() {
                if (readCookie("theme") == "dark") {
                    $("html").removeClass("dark-mode");
                    createCookie("theme", "", "");
                } else {
                    $("html").addClass("dark-mode");
                    createCookie("theme", "dark", "");
                }
            }

            function resetAccessibilitySettings() {
                if (confirm("Are you sure you want to reset all accessibility settings?")) {
                    // Reset font size
                    $("html").css("font-size", "100%");
                    createCookie("font-resize", 0, "");

                    // Reset theme
                    $("html").removeClass("dark-mode");
                    createCookie("theme", "", "");

                    // Reset high contrast
                    $("html").removeClass("high-contrast");
                    createCookie("high-contrast", false, "");

                    // Reset focus indicators
                    $("html").removeClass("enhanced-focus");
                    createCookie("focus-indicators", true, "");

                    // Reset reduce motion
                    $("html").removeClass("reduce-motion");
                    createCookie("reduce-motion", false, "");

                    // Reset tooltips
                    enableTooltips(false);
                    createCookie("tooltips", false, "");
                }
            }
        </script>

    </head>        
    <body>
        <!-- Bootstrap JavaScript Bundle (includes Popper.js) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        
        <!-- Error Popup System -->
        <script src="{{ url_for('static', filename='javascript/error-popup.js') }}"></script>
        
        <!-- Global Accessibility System -->
        <script src="{{ url_for('static', filename='javascript/accessibility.js') }}"></script>

        {% if show_navbar != false %}
        <nav class="navbar navbar-expand-lg my-5" id="nav-bar">
            <div class="container-fluid">
                <!-- Top row for small screens: Logo + User Profile -->
                <div class="d-flex justify-content-between align-items-center w-100 d-lg-none mb-2">
                    <img src="{{ url_for('static', filename='images/noaa_banner.png') }}" alt="NOAA Banner" width="30%" height="30%" onclick="window.location.href = '{{ url_for("corrections.index")}}'" style="cursor: pointer;">
                    
                    <!-- User Profile Icon - Small screens -->
                    {% if current_user.is_authenticated %}
                    <div class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn p-0" type="button" id="userDropdownMobile" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="border: none; background: none;">
                                <div class="user-avatar user-avatar-mobile" title="{{ current_user.name }}">
                                    <span class="user-initials">{{ current_user.name.split()[0][0] }}{% if current_user.name.split()|length > 1 %}{{ current_user.name.split()[-1][0] }}{% endif %}</span>
                                </div>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdownMobile">
                                <div class="dropdown-header">
                                    <strong>{{ current_user.name }}</strong><br>
                                    <small class="text-muted">{{ current_user.username }}</small>
                                </div>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Large screens: Logo only -->
                <img src="{{ url_for('static', filename='images/noaa_banner.png') }}" alt="NOAA Banner" width="20%" height="20%" onclick="window.location.href = '{{ url_for("corrections.index")}}'" style="cursor: pointer;" class="d-none d-lg-block">  
                
                <!-- Navbar toggler for small screens -->
                <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <!-- <li class="nav-item active">
                        <a class="nav-link" id="nav-items" href="/">Corrections </a>
                    </li> -->
                    <li class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Corrections
                            </button>
                            <div class="dropdown-menu" id="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                <a class="dropdown-item" href="{{ url_for('corrections.daily_corrections') }}">Daily Correction</a>
                                <a class="dropdown-item" href="{{ url_for('corrections.monthly_corrections') }}">Monthly Correction</a>
                                <a class="dropdown-item" href="{{ url_for('corrections.range_corrections') }}">Ranged Correction</a>
                                <a class="dropdown-item" href="{{ url_for('corrections.hourly_corrections') }}">Hourly Correction</a>
                                <a class="dropdown-item" href="{{ url_for('corrections.multiday_corrections') }}">Multi-Day Correction</a>
                                <a class="dropdown-item" href="{{ url_for('corrections.previous_corrections') }}">Previous Corrections</a>
                      
                            </div>
                        </div>
                    </li>
                    <!-- <li class="nav-item active">
                        <a class="nav-link" id="nav-items" href="{{ url_for('ghcndata.view_ghcn_data') }}">View Data </a>
                    </li> -->
                    <li class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton2" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                View Data
                            </button>
                            <div class="dropdown-menu" id="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                                <a class="dropdown-item" href="{{ url_for('ghcndata.view_ghcn_data') }}">View GHCN Daily</a>
                                <a class="dropdown-item" href="{{ url_for('ghcndata.view_ghcn_hourly_data') }}">View GHCN Hourly</a>
                      
                            </div>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton3" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Utilities
                            </button>
                            <div class="dropdown-menu" id="dropdown-menu" aria-labelledby="dropdownMenuButton3">
                                <a class="dropdown-item" href="#">Defaults</a>
                                <a class="dropdown-item" href="#">Send Corrections</a>
                                <a class="dropdown-item" onclick="tempGenerateMonthlyPub()" href="#">Create Monthly Publication</a>
                                <a class="dropdown-item" href="#">Zip/FTP Monthly Publication</a>
                                <a class="dropdown-item" href="#">Create Annual Publication</a>
                                <a class="dropdown-item" href="#">Zip/FTP Annual Publication</a>
                                <a class="dropdown-item" href="#">Generate Monthly QA Report</a>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton4" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Resources
                            </button>
                            <div class="dropdown-menu" id="dropdown-menu" aria-labelledby="dropdownMenuButton4">
                                <a class="dropdown-item" href="{{ url_for('resources.readme') }}">Read Me</a>
                                <a class="dropdown-item" href="{{ url_for('resources.country_codes') }}">Country Codes</a>
                                <a class="dropdown-item" href="{{ url_for('resources.class_definitions') }}">Class Definitions</a>
                                <a class="dropdown-item" href="{{ url_for('resources.accessibility') }}">Accessibility</a>
                            </div>
                        </div>
                    </li>
                </ul>
                
                <!-- User Profile Icon - Large screens only -->
                {% if current_user.is_authenticated %}
                <div class="navbar-nav ms-auto d-none d-lg-flex">
                    <div class="nav-item dropdown">
                        <div class="dropdown">
                            <button class="btn p-0" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="border: none; background: none;">
                                <div class="user-avatar" title="{{ current_user.name }}">
                                    <span class="user-initials">{{ current_user.name.split()[0][0] }}{% if current_user.name.split()|length > 1 %}{{ current_user.name.split()[-1][0] }}{% endif %}</span>
                                </div>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <div class="dropdown-header">
                                    <strong>{{ current_user.name }}</strong><br>
                                    <small class="text-muted">{{ current_user.username }}</small>
                                </div>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
              </div>
            </div>
          </nav>
          {% endif %}
       
       <!-- Flash Messages Integration -->
       {% with messages = get_flashed_messages(with_categories=true) %}
           {% if messages %}
               <script>
                   document.addEventListener('DOMContentLoaded', function() {
                       {% for category, message in messages %}
                           {% if category == 'error' %}
                               errorPopup.error('{{ message|e }}');
                           {% elif category == 'warning' %}
                               errorPopup.warning('{{ message|e }}');
                           {% elif category == 'info' %}
                               errorPopup.info('{{ message|e }}');
                           {% elif category == 'success' %}
                               errorPopup.success('{{ message|e }}');
                           {% else %}
                               errorPopup.info('{{ message|e }}');
                           {% endif %}
                       {% endfor %}
                   });
               </script>
           {% endif %}
       {% endwith %}
       
       {% block content %}{% endblock content %}

    
        <script>
            window.onload = function() {
                // Accessibility settings are now initialized globally in the head section
                // This ensures they apply across all pages
            };
            
            // Tool Tip Functionality
            const tooltips = document.querySelectorAll('.tt')
            tooltips.forEach(t => {
              new bootstrap.Tooltip(t)
            })
            
            
            


                function correctionFormHandler(formData, handleData) {
                        // Aend the form data via AJAX
                        $.ajax({
                            url: '/process_correction',
                            method: 'POST',
                            data: formData,
                            success: function (response) {
                                // function that handles async response at caller
                                handleData(response)
                            },
                            error: function (xhr, status, error) {
                                console.error("Error:", error);
                                handleAjaxError(xhr, status, error, "There was an error processing your correction request.");
                                // Debugging
                                handleData()
                            }
                        });

                    }


                    function tempGenerateMonthlyPub() {
                        console.log("Generating monthly pub...");
                    
                        $.ajax({
                            url: '/test_monthlyPub',  // This matches your Flask route
                            method: 'GET',
                            success: function(response) {
                                console.log("Response:", response);
                                handleAjaxSuccess("Monthly publication generated successfully!");
                            },
                            error: function(xhr, status, error) {
                                console.error("Error:", error);
                                handleAjaxError(xhr, status, error, "Error generating monthly publication.");
                            }
                        });
                    }
            
            /**
             * Displays a confirmation page after corrections have been successfully submitted.
             *
             * This function presents a "Corrections have been submitted successfully" page to the user.
             * It provides options for the user to submit another correction of the same type or to
             * select a different type of correction.
             *
             * @param {string} type - The type of correction that was submitted (e.g., 'daily', 'monthly', 'ranged', 'hourly', 'multiday').
             */
            function showSubmissionConfirmation(type) {

                $("#form-daily").hide(); 
                $("#form-hourly").hide(); 
                $("#form-monthly").hide(); 
                $("#form-range").hide(); 
                $("#form-multiday").hide();
                
                $(".correction-type-text-target").text(type);
                
                var element_name = "submitted-" + type + "-link";
                //Hide that element

                var link = "";
                if (type == "daily") {
                    link = '{{ url_for('corrections.daily_corrections') }}';
                    $("#submitted-daily-link").hide();
                    
                    
                } else if (type == "monthly") {
                    link = '{{ url_for('corrections.monthly_corrections') }}';
                    $("#submitted-monthly-link").hide();
                } else if (type == "ranged") {
                    link = '{{ url_for('corrections.range_corrections') }}';
                    $("#submitted-ranged-link").hide();
                } else if (type == "hourly") {
                    link = '{{ url_for('corrections.hourly_corrections') }}';
                    $("#submitted-hourly-link").hide();
                } else if (type == "multiday") {
                    link = '{{ url_for('corrections.multiday_corrections') }}';
                    $("#submitted-multiday-link").hide();
                }

                console.log(link);

                $("#submit-another-correction").click(function() {
                    window.location.href = link;
                });



                $("#submission-element").show(); 


            }

            /**
             * Formats form data with weather sub-elements into a URL query string.
             *
             * This function processes form data containing "WEATHER ELEMENT" and "WEATHER SUBELEMENT"
             * fields. It replaces the main `element` value with the selected sub-element value
             * (e.g., 'WT**' becomes 'WT01') and removes the extraneous sub-element fields
             * from the data before serializing it. Meant to be used on Corrections Pages.
             *
             * @param {jQuery} formData - A jQuery object representing the form element, typically obtained
             * from a form submission event handler (e.g., `$(this)`).
             * @returns {string} A string of URL-encoded parameters ready for submission,
             * such as `ghcn_id=USW00093991&date=2025-08-06&element=WT01&action=1`.
             */
            function formatWeatherDataQuery(formData) {
                const form = formData.get(0);
                var formData = formData.serialize().split("&");
                // console.log("FORMDATA: ", formData);
                sub_element_str = "element=";
                element_index = formData.findIndex((element => element.indexOf("element=") != -1));
                if (element_index == -1) {
                    console.log("Element was not found in form response.")
                    // Throw an exception or an error.
                }
                // Replace ELEMENT subselection if relevant.
                switch (form.elements.element.value.toString()) {
                    case "SN*#": {
                        // Get the value from the sub-element
                        const newValue = form.elements.sub_element_SN.value.toString();
                        // console.log("new value:", newValue)
                        formData[element_index] = sub_element_str + newValue;
                        break;
                    }
                    case "SX*#": {
                        const newValue = form.elements.sub_element_SX.value.toString();
                        // console.log("new value:", newValue)
                        formData[element_index] = sub_element_str + newValue;
                        break;
                    }
                    case "WT**": {
                        const newValue = form.elements.sub_element_WT.value.toString();
                        // console.log("new value:", newValue)
                        formData[element_index] = sub_element_str + newValue;
                        break;
                    }
                    case "WV**": {
                        const newValue = form.elements.sub_element_WV.value.toString();
                        // console.log("new value:", newValue)
                        formData[element_index] = sub_element_str + newValue;
                        break;
                    }
                    default:  
                }

                // Remove Sub Elements from form parameters
                let index = formData.findIndex((element => element.indexOf("sub_element_SN=") != -1));
                if (index !== -1) {
                    formData.splice(index,4);
                    // console.log(formData);
                    return formData.join("&")
                } else {
                    // For some reason there is not "sub_element_SN=" in the form object. 
                    console.log("sub_element_SN= was not found.");
                    return 
                }
            }
            
        </script>
    </body>
</html>